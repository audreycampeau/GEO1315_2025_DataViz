# Charger les bibliothèques nécessaires
library(forecast)

# Définir les données manuellement
Category <- c(1901, 1902, 1903, 1904, 1905, 1906, 1907, 1908, 1909, 1910,
              1911, 1912, 1913, 1914, 1915, 1916, 1917, 1918, 1919, 1920,
              1921, 1922, 1923, 1924, 1925, 1926, 1927, 1928, 1929, 1930,
              1931, 1932, 1933, 1934, 1935, 1936, 1937, 1938, 1939, 1940,
              1941, 1942, 1943, 1944, 1945, 1946, 1947, 1948, 1949, 1950,
              1951, 1952, 1953, 1954, 1955, 1956, 1957, 1958, 1959, 1960,
              1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969, 1970,
              1971, 1972, 1973, 1974, 1975, 1976, 1977, 1978, 1979, 1980,
              1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990,
              1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000,
              2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010,
              2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020,
              2021, 2022)

Annual_Mean <- c(1522.91, 1522.91, 1522.91, 1440.12, 1522.91, 1637.42, 1367.14, 1437.26,
                 1744.44, 1594.18, 1516.52, 1737.41, 1196.03, 1344.59, 1474.03, 1636.19,
                 1102.59, 1441.17, 1371.17, 1564.76, 1460.64, 1457.73, 1537.75, 1514.02,
                 1624.82, 1522.91, 1481.62, 1414.00, 1585.61, 1226.03, 1270.33, 1303.6,
                 1394.95, 1442.22, 1496.27, 1410.2, 1600.65, 1302.8, 1484.82, 1425.34,
                 1334.3, 1383.64, 1258.67, 1702.7, 1590.47, 1562.62, 1595.5, 1478.09,
                 1498.00, 1601.02, 1558.52, 1426.64, 1394.28, 1454.7, 1592.81, 1287.93,
                 1434.85, 1087.05, 1477.29, 1528.89, 1849.43, 1573.98, 1550.63, 1536.73,
                 1450.26, 1748.22, 1303.65, 1489.69, 1691.2, 1587.97, 1355.05, 1349.58,
                 1574.38, 1511.31, 1553.42, 1507.47, 1523.24, 1198.23, 1525.11, 1650.89,
                 1502.27, 1383.69, 1408.09, 1460.68, 1656.58, 1493.77, 1519.51, 1543.89,
                 1548.98, 1603.7, 1374.07, 1353.35, 1437.79, 1676.1, 1552.45, 1406.01,
                 1658.34, 1632.32, 1747.36, 1531.55, 1376.14, 1789.2, 1493.14, 1489.83,
                 1433.51, 1634.11, 1601.51, 1618.97, 1620.95, 1487.26, 1552.19, 1473.86,
                 1538.03, 1306.17, 1489.66, 1623.29, 1718.03, 1578.54, 1600.97, 1877.87,
                 1479.5, 1747.64)

# Convertir en série temporelle
data_ts <- ts(Annual_Mean, start = min(Category), frequency = 1)

# Ajuster un modèle de régression linéaire
model <- tslm(data_ts ~ trend)

# Vérifier si le modèle a été correctement ajusté
if (exists("model")) {
  # Faire des prévisions pour les 10 prochaines années
  forecast_data <- forecast(model, h = 10)
  
  # Visualiser les prévisions
  plot(forecast_data, main = "Projection de la Moyenne Annuelle", ylab = "Annual Mean", xlab = "Année")
} else {
  print("Le modèle n'a pas pu être ajusté correctement.")
}



